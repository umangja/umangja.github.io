<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Umang Jain ">
<meta name="description" content="Slides
Lecture
Introduction In this lecture, We are working with Planing means someone gives us how the environment works i.e. someone tells us rewards function and State probability transition
And we have MDPs means environment is fully observable.
Policy Evaluation Now, we are given a policy $ \pi $ and our MDP = &amp;lt; S,A,P,R, $ \gamma $ &amp;gt;
and we need to find the value function for that policy" />
<meta name="keywords" content=", RL" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="https://umangja.github.io/posts/2021/01/introdution-to-dynamic-programming/" />


    <title>
        
            Introdution to Dynamic Programming :: UMANG JAIN  — Blogs
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://umangja.github.io/main.a53c5881c12495ab068658c69596fa775d6a0a4162ff4198ccc7ddabd912fb8f.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://umangja.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://umangja.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://umangja.github.io/favicon-16x16.png">
    <link rel="manifest" href="https://umangja.github.io/site.webmanifest">
    <link rel="mask-icon" href="https://umangja.github.io/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="https://umangja.github.io/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">



<meta itemprop="name" content="Introdution to Dynamic Programming">
<meta itemprop="description" content="Slides
Lecture
Introduction In this lecture, We are working with Planing means someone gives us how the environment works i.e. someone tells us rewards function and State probability transition
And we have MDPs means environment is fully observable.
Policy Evaluation Now, we are given a policy $ \pi $ and our MDP = &lt; S,A,P,R, $ \gamma $ &gt;
and we need to find the value function for that policy">
<meta itemprop="datePublished" content="2021-01-22T17:01:37+05:30" />
<meta itemprop="dateModified" content="2021-01-22T17:01:37+05:30" />
<meta itemprop="wordCount" content="650">
<meta itemprop="image" content="https://umangja.github.io"/>



<meta itemprop="keywords" content="RL," />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://umangja.github.io"/>

<meta name="twitter:title" content="Introdution to Dynamic Programming"/>
<meta name="twitter:description" content="Slides
Lecture
Introduction In this lecture, We are working with Planing means someone gives us how the environment works i.e. someone tells us rewards function and State probability transition
And we have MDPs means environment is fully observable.
Policy Evaluation Now, we are given a policy $ \pi $ and our MDP = &lt; S,A,P,R, $ \gamma $ &gt;
and we need to find the value function for that policy"/>



    <meta property="og:title" content="Introdution to Dynamic Programming" />
<meta property="og:description" content="Slides
Lecture
Introduction In this lecture, We are working with Planing means someone gives us how the environment works i.e. someone tells us rewards function and State probability transition
And we have MDPs means environment is fully observable.
Policy Evaluation Now, we are given a policy $ \pi $ and our MDP = &lt; S,A,P,R, $ \gamma $ &gt;
and we need to find the value function for that policy" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://umangja.github.io/posts/2021/01/introdution-to-dynamic-programming/" />
<meta property="og:image" content="https://umangja.github.io"/>
<meta property="article:published_time" content="2021-01-22T17:01:37+05:30" />
<meta property="article:modified_time" content="2021-01-22T17:01:37+05:30" />




    <meta property="article:section" content="Tutorial" />



    <meta property="article:published_time" content="2021-01-22 17:01:37 &#43;0530 IST" />








    </head>

    <body class="dark-theme">


<script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101298385);</script>
<script async src="//static.getclicky.com/js"></script>


        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://umangja.github.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>

        <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://umangja.github.io/about/">About</a></li><li><a href="https://umangja.github.io/blogs">Blogs</a></li><li><a href="https://www.linkedin.com/in/umangjain5000/">Contact</a></li><li><a href="https://umangja.github.io/posts/">Posts</a></li><li><a href="https://umangja.github.io/files/resume.pdf">Resume</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        4 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://umangja.github.io/posts/2021/01/introdution-to-dynamic-programming/">Introdution to Dynamic Programming</a>
      </h1>

      

      <div class="post-content">
        <p><a href="https://www.davidsilver.uk/wp-content/uploads/2020/03/DP.pdf">Slides</a></p>
<p><a href="https://www.youtube.com/watch?v=Nd1-UUMVfz4&amp;list=PLqYmG7hTraZDM-OYHWgPebj2MfCFzFObQ&amp;index=3">Lecture</a></p>
<h2 id="introduction">Introduction</h2>
<p>In this lecture, We are working with Planing means someone gives us how the environment works i.e. someone tells us <strong>rewards function</strong> and <strong>State probability transition</strong></p>
<p>And we have MDPs means environment is fully observable.</p>
<h2 id="policy-evaluation">Policy Evaluation</h2>
<p>Now, we are given a policy $ \pi $ and our MDP  = &lt; S,A,P,R, $ \gamma $ &gt;</p>
<p>and we need to find the value function for that policy</p>
<p>Now Acc. to Bellman expectation equation</p>
<p>$  v_{\pi}[s] = \sum \pi[a|s] * q_{\pi}[s,  a] $</p>
<p>$  q_{\pi}[s,  a] = R_s^a + \sum P^a_{s s^{'}} * v_{\pi}[s^{'}] $</p>
<p>$  v_{\pi}[s] = \sum \pi[a|s] * ( R_s^a + \sum P^a_{s s^{'}} * v_{\pi}[s^{'}]) $</p>
<h3 id="method---1">Method - 1</h3>
<p>we can find average reward function over our current policy, $ \pi $ , and average state transition probability over $ \pi $  then,</p>
<p>$ v_{\pi}[s] = R^{\pi}_s + \sum P^{\pi}_{ss^{'}} * v_{\pi}[s^{'}] $</p>
<p>Now, we can write the above equation in matrix form and then find value function, V, by using inversion of matrix.</p>
<h3 id="method---2---iterative-policy-evaluation">Method - 2 :- Iterative Policy Evaluation</h3>
<p>Here, we start with a random value function and improve it over many iteration by iteratively applying Bellman expectation equation.</p>
<p>$  v_{\pi}[s] = \sum \pi[a|s] * ( R_s^a + \sum P^a_{s s^{'}} * v_{\pi}[s^{'}]) $</p>
<h2 id="principle-of-optimality">Principle of optimality</h2>
<p>It&rsquo;s means that an optimal policy is one that</p>
<ol>
<li>
<p>first take optimal action</p>
</li>
<li>
<p>and then follow optimal policy from successive state</p>
</li>
</ol>
<p>A policy π(a|s) achieves the optimal value from state s,
$ v_π(s) = v^∗(s) $,  if and only if
For any state s' reachable from s π achieves the optimal value from state s'
i.e.   $ v_π(s') = v∗(s') $</p>
<h2 id="policy-improvement-theorem">Policy Improvement Theorem</h2>
<p>Let $\pi$ and $ \pi^{'} $ be two deterministic policy such that</p>
<p>$$  q_{\pi}(s,\pi^{'}[s]) &gt;= v_{\pi}[s] $$</p>
<p>Then the policy π' must be as good as, or better than, π. i.e.</p>
<p>$ v_{\pi^{'}}[s] &gt;= v_{\pi} $ for all state s</p>
<h2 id="policy-improvement">Policy Improvement</h2>
<p>Here, we are given a policy and we need to improve it or from given policy we need to find optimal policy and corresponding value function.</p>
<p>We evaluate the current policy, $ \pi $, and find state value function using Iterativer policy evaluation and then greedily update our policy.</p>
<ol>
<li>
<p>$ \pi^{'} = greedy(v_{\pi}) $</p>
</li>
<li>
<p>This process always converges to $ \pi_{*} $</p>
</li>
</ol>
<p>by greedy we mean that we will choose action/state which will lead to maximum value function (action or state)</p>
<p>Let $ \pi $ be a <strong>deterministic</strong> policy</p>
<p>$ \pi^{'}[s] = max_{a} q_{\pi}[a|s] $</p>
<p>We can prove this will always be $ \pi^{'}[s] $ will always be better than $ \pi $</p>
<p>and</p>
<p>After several interation we will converge on $ \pi^{*} $</p>
<p>** we may also stop after some K iterative of policy improvement steps knows as k - convergence of value function  **</p>
<h2 id="value-interation">Value Interation</h2>
<p>Idea is we know the value funciton forany state then we can use <strong>Bellman optimality equation</strong> to get optimal value funtion to its preceding state.</p>
<p>Intition is to start from final/terminating state and work backwords.</p>
<p>$ V_*[s] = max_a(R_s^a + \sum P^a_{ss'} * V[s'] ) $</p>
<p>It can also be proven that it will also convege to optimal policy</p>
<p><strong>Notice that here intermediate value function do not have any meaning means there may not exist a policy that will give a particular intermediate value function</strong></p>
<h2 id="asynchronous-dp">Asynchronous DP</h2>
<p>In Synchronous Dp we update all state value function at once, But in asynchronous DP we update individual states value function.</p>
<p>Helps to reduce commutation speed.</p>
<p><strong>Will still lead to convergence if all states are choosen</strong></p>
<h3 id="in-place-dp">In-place DP</h3>
<p>Just keep updating on the go.</p>
<h3 id="priority-based-dp">Priority based DP</h3>
<p>Select state to update based on it&rsquo;s priority.</p>
<p>Priority can be defined as the Bellman error.</p>
<p>$ error/priority = abs( max_a(R_s^a + \sum P^a_{ss'} * V[s'] ) -v[s]) $</p>
<h3 id="real-time-dp">Real Time DP</h3>
<p>Get a real agent in the environment and update each state once it is visited.</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://umangja.github.io/tags/rl/">RL</a></span>
        
    </p>

      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://umangja.github.io/categories/tutorial/">Tutorial</a></span>
        
    </p>


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        650 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2021-01-22 17:01
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fumangja.github.io%2fposts%2f2021%2f01%2fintrodution-to-dynamic-programming%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>






<a class="resp-sharing-button__link" href="mailto:?subject=Introdution%20to%20Dynamic%20Programming&amp;body=https%3a%2f%2fumangja.github.io%2fposts%2f2021%2f01%2fintrodution-to-dynamic-programming%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>




<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fumangja.github.io%2fposts%2f2021%2f01%2fintrodution-to-dynamic-programming%2f&amp;title=Introdution%20to%20Dynamic%20Programming&amp;summary=Introdution%20to%20Dynamic%20Programming&amp;source=https%3a%2f%2fumangja.github.io%2fposts%2f2021%2f01%2fintrodution-to-dynamic-programming%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>










      </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
          <hr />
        </div>

        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://umangja.github.io/posts/2021/01/model-free-prediction/">
                <span class="button__icon">←</span>
                <span class="button__text">Model Free Prediction</span>
              </a>
            </span>
          

          
            <span class="button next">
              <a href="https://umangja.github.io/posts/2021/01/markov-decision-process/">
                <span class="button__text">Markov Decision Process</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    


    

  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
                <span><a href="https://umangja.github.io">Umang Jain</a></span>
            
            
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            
            
          </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span> <a href="http://github.com/umangja">Developer</a> </span>
            <span> <a href="https://codeforces.com/profile/TooStupidToWin">Geek</a> </span>
            
          </div>
    </div>
</footer>



            
        </div>

        




<script type="text/javascript" src="https://umangja.github.io/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js" integrity="sha512-3HFukJLJggt3&#43;W2ilNASCu6xibW86pdSMJ6&#43;on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script>



    </body>
</html>
